# Changez de répertoire vers le dossier contenant les sources etcd
cd /chemin/vers/etcd-3.4.32

# Créez le Dockerfile
cat <<EOF > Dockerfile
FROM golang:1.17 as builder
WORKDIR /etcd
COPY . .
RUN ./build

FROM alpine:3.14
COPY --from=builder /etcd/bin/etcd /usr/local/bin/
COPY --from=builder /etcd/bin/etcdctl /usr/local/bin/
EXPOSE 2379 2380
ENTRYPOINT ["/usr/local/bin/etcd"]
EOF

# Construisez l'image Docker
sudo podman build -t localhost:443/etcd:3.4.32 .

# Poussez l'image vers le registre local
sudo podman push localhost:443/etcd:3.4.32

# Vérifiez les images dans le registre local
sudo podman images

